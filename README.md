## Специфика задачи
Предсказать по SMILES density, thermal conductivity(Tc), glass transition temperature(Tg), packing efficiency radius of gyration(Rg) и fractional free volume(FFV).
Главная проблема заключается в том, что большинство target-переменных отсутствуют в датасете или запись в датасете содержит информацию лишь об одном таргете или в лучше случае о двух.
Пропусков настолько много, что их не представляется возможным заполнить классическими стратегиями с помощью статистического анализа.
То есть ключевыми данными для задачи выступает SMILES и вычленение из этой строки информации различными способами: с помощью фингерпринтов, с помощью молекулярных дескрипторов, с помощью эмбеддингов ChemBERTA и т.д..

## ML approach
### Подход №1: Random Forest по RDKit дескрипторам для каждого таргета
Самый очевидный ML-подход, который выступает в качестве бейзлайна, это RF для каждого таргета по тем записям, в которых он встречается. Мы берём в выборку только те строки, в которых есть соответствующий таргет.
В качестве признаков выступает набор молекулярных дескрипторов, полученных с помощью RDKit.

**Физико-химические свойства (Physicochemical):**  
MolWt (Молекулярный вес)  
ExactMolWt (Точный молекулярный вес)  
HeavyAtomCount (Число тяжелых атомов)  
MolLogP (Логарифм коэффициента распределения)  
MolMR (Молекулярная рефракция)  
TPSA (Топологическая площадь полярной поверхности)  
LabuteASA (Оценка площади поверхности по Лабюту)  
  
**Гибкость (Flexibility):**  
NumRotatableBonds (Число вращающихся связей)    
FractionCSP3 (Доля атомов углерода в sp3-гибридизации)   
RingCount (Общее число циклов)  
NumAromaticRings (Число ароматических циклов)    
NumAliphaticRings (Число алифатических циклов)  

**Водородные связи (H-bonding):**
NumHAcceptors (Число акцепторов водородных связей)  
NumHDonors (Число доноров водородных связей)  
Топологические (графовые) дескрипторы (Graph)  
BertzCT (Индекс сложности Бертца)  
HallKierAlpha (Альфа Холла-Кира)  
Chi0 (Индекс связи нулевого порядка)  
Chi1 (Индекс связи первого порядка)  
Chi2n (Индекс связи второго порядка, нормализованный)  
Chi3n (Индекс связи третьего порядка, нормализованный)  
Chi4n (Индекс связи четвертого порядка, нормализованный)  
Kappa1 (Индекс формы Каппа 1)  
Kappa2 (Индекс формы Каппа 2)  
Kappa3 (Индекс формы Каппа 3)  
BalabanJ (Индекс Балабана J)  

### Подход №2: LSTM molecular predictor 
Он работает из коробки, токенизируя SMILES, строя эмбеддинг и прогоняя это через LSTM. Последнее скрытое состояние (h_last) — это векторное представление всей молекулы, это подаётся в MLP для предсказания свойств
по отдельности Tg, Tc, Rg, FFV. 
Один из вариантов бейзлайна, который хорош тем, что учитывает структуру SMILES.

**Беда сейчас в том, что не запускается из-за ограничений по памяти**

### Подход №3: Гибрид
Эмбеддинг SMILES, полученный из LSTM, рассматривается как ещё один «набор признаков», этот вектор объединяется с RDKit-дескрипторами, а дальше всё скармливается в RandomForest (или другой бустинг)

**Беда сейчас в том, что не отлажен и не запускается из-за ограничений по памяти**

## Идеи:
1. Выбирать из имеющихся наиболее информативные дескрипторы, добавлять другие дескрипторы, описанные в документации RDKit, создавать новые, которых нет в RDKit и которые несут физический смысл для данной задачи.
2. Попробовать фингерпринты и XGBoost вместе
3. Для DL: ChemBERTA и GNN

## TODO:
1. Работоспособность подходов №2, 3 и доведение всех трёх до submission
2. requirements.txt
3. Зарефакторить, чтобы было удобнее переключаться между модельками
